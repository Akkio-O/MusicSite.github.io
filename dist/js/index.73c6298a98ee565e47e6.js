(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");if(o.length)for(var c=o.length-1;c>-1&&(!t||!/^http(s?):/.test(t));)t=o[c--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t+"../"})();const t=document.querySelector(".count__cart"),n=document.querySelector(".easynetshop_wrapper"),o=document.querySelector(".modal_subtitle__visible"),c=document.querySelector(".easynetshop-goods"),a=document.querySelector(".btn_buy__decoration");let s=0;const r=document.getElementById("deliveryType"),l=document.querySelector(".easynetshop-deliveryprice");function i(){const e=document.querySelectorAll(".itemBlock");let t=0,n=0,o=0;e.forEach((e=>{const c=e.querySelector(".easynetshop-cur-price"),a=e.querySelector(".easynetshop-cur-old-price span.old_price"),s=e.querySelector(".easynetshop-deliveryprice"),r=e.querySelector("[data-counter]"),l=parseInt(r.textContent);if(c){const e=parseFloat(c.textContent.replace(/[^\d.]/g,""));t+=e*l}if(a){const e=parseFloat(a.textContent.replace(/[^\d.]/g,""));n+=e*l}if(s){const e=parseFloat(s.textContent.replace(/[^\d.]/g,""));o+=e}}));const c=document.querySelector(".easynetshop-discountallprice"),a=document.querySelector(".easynetshop-goodsprice"),r=document.querySelector(".easynetshop-allprice");let l=t+parseFloat(s),i=document.querySelector("[data-preTotalPrice]"),d=document.querySelector("[data-TotalPrice]");function u(e,t){e.textContent=t.toLocaleString("ru-RU").replace(/[^\d.]/g,"")}u(c,t),u(i,n),u(d,l),u(a,n),u(r,l);let p=document.querySelector("[data-TotalDiscount]"),m=n-l;p.textContent=m.toLocaleString("ru-RU")}r.addEventListener("change",(function(){const e=this.value;s="cityDelivery"===e?300:0,l.textContent=s.toFixed(2),i();let t=document.querySelector("[data-Delivery]");t=t.textContent=0!==s?s:"Бесплатно"}));const d=[];function u(){const e=d.length;t.textContent=e}function p(e){e.remove();const t=d.indexOf(e);-1!==t&&d.splice(t,1);0===document.querySelectorAll(".itemBlock").length&&(c.style.display="none",o.style.display="block",a.style.display="none"),i(),u()}function m(){let e=document.querySelector("[data-quanity]");const t=document.querySelectorAll("[data-counter]"),n=Array.from(t).reduce(((e,t)=>e+parseInt(t.textContent,10)),0);e.textContent=n}window.addEventListener("click",(function(e){const t=e.target,s=t.dataset.action,r=t.hasAttribute("data-buy"),l=t.hasAttribute("data-buyItem");if(s){const e=t.closest(".counter-wrapper");if(!e)return;const n=e.querySelector("[data-counter]");let o=parseInt(n.textContent);"plus"===s?o++:"minus"===s&&o>0&&o--,n.textContent=o}r&&(!function(e){const t=e.closest(".catalog_content"),s=t.getAttribute("data-XML_ID"),r=t.querySelector(".catalog-item__img").getAttribute("src"),l=t.querySelector(".catalog-item__subtitle").textContent,_=t.querySelector(".catalog-item__old-price").textContent,y=t.querySelector(".catalog-item__price").textContent,g=t.querySelector(".discount").textContent;if(Array.from(n.querySelectorAll(".easynetshop-goodtitle")).some((e=>e.getAttribute("data-XML_ID")===s)))console.log("Что-то не так");else{const e=document.createElement("div");e.className="row itemBlock",e.innerHTML=`\n            <div class="easynetshop-goodtitle col" data-XML_ID="${s}">\n                <img src="${r}" class="item-img col">\n            </div>\n            <div class="col">\n                <span class="easynetshop-goodtitle-name col">${l}</span><br>\n            </div>\n            <div class="easynetshop col">\n                <div class="catalog-item__items counter-wrapper">\n                    <div class="items_control control" data-action="minus">-</div>\n                    <div class="items_control" data-counter>1</div>\n                    <div class="items_control control" data-action="plus">+</div>\n                </div>\n            </div>\n            <div class="easynetshop price_block col">\n            <div data-price="SIGMApc15" class="easynetshop-cur-old-price">\n                <span class="old_price">${_}</span>\n                <span class="discount">${g}%</span>\n            </div>\n                <span class="easynetshop-cur-price">${y}</span>\n                <span class="easynetshop-currency">руб.</span>\n            </div>\n            <div class="col">\n                <button type="button" class="easynetshop-delgood" data-rel="1" title="Удалить из корзины">×</button>\n            </div>\n        `,n.appendChild(e),d.push(e),i(),u(),c.style.display="block",o.style.display="none",a.style.display="block",e.querySelector(".easynetshop-delgood").addEventListener("click",(()=>p(e))),window.addEventListener("click",(function(e){const t=e.target;t.dataset.action,n.contains(t)&&(document.querySelectorAll(".itemBlock").forEach((e=>{if(0===parseInt(e.querySelector("[data-counter]").textContent)){e.remove();const t=d.indexOf(e);-1!==t&&d.splice(t,1)}})),0===document.querySelectorAll(".itemBlock").length&&(c.style.display="none",o.style.display="block",a.style.display="none"),i(),u(),m())}))}}(t),m()),l&&(!function(e){const t=e.closest("main"),s=t.querySelector(".product__container_img").style.backgroundImage.replace('url("',"").replace('")',""),r=t.querySelector(".product__container").getAttribute("data-XML_ID"),l=s,_=t.querySelector(".product__container_title").textContent,y=t.querySelector(".catalog-item__old-price").textContent,g=t.querySelector(".catalog-item__price").textContent,C=t.querySelector(".discount").textContent;if(Array.from(n.querySelectorAll(".easynetshop-goodtitle")).some((e=>e.getAttribute("data-XML_ID")===r)))console.log("Что-то не так");else{const e=document.createElement("div");e.className="row itemBlock",e.innerHTML=`\n            <div class="easynetshop-goodtitle col" data-XML_ID="${r}">\n                <img src="${l}" class="item-img col">\n            </div>\n            <div class="col">\n                <span class="easynetshop-goodtitle-name col">${_}</span><br>\n            </div>\n            <div class="easynetshop col">\n                <div class="catalog-item__items counter-wrapper">\n                    <div class="items_control control" data-action="minus">-</div>\n                    <div class="items_control" data-counter>1</div>\n                    <div class="items_control control" data-action="plus">+</div>\n                </div>\n            </div>\n            <div class="easynetshop price_block col">\n                <div data-price="SIGMApc15" class="easynetshop-cur-old-price">\n                    <span class="old_price">${y}</span>\n                    <span class="discount">${C}%</span>\n                </div>\n                <span class="easynetshop-cur-price">${g}</span>\n                <span class="easynetshop-currency">руб.</span>\n            </div>\n            <div class="col">\n                <button type="button" class="easynetshop-delgood" data-rel="1" title="Удалить из корзины">×</button>\n            </div>\n        `,n.appendChild(e),d.push(e),i(),u(),c.style.display="block",o.style.display="none",a.style.display="block",e.querySelector(".easynetshop-delgood").addEventListener("click",(()=>p(e))),window.addEventListener("click",(function(e){const t=e.target;n.contains(t)&&(document.querySelectorAll(".itemBlock").forEach((e=>{if(0===parseInt(e.querySelector("[data-counter]").textContent)){e.remove();const t=d.indexOf(e);-1!==t&&d.splice(t,1)}})),0===document.querySelectorAll(".itemBlock").length&&(c.style.display="none",o.style.display="block",a.style.display="none"),i(),u(),m())}))}}(t),m())}));const _=document.querySelector(".catalog_block"),y=document.querySelector("#pagination"),g=12;let C=[];const h=12;let v=6,f=0;function I(e){const t=document.createElement("div");t.classList.add("col-auto","col-xxl-3.5");let n=100-100*e.CV_PRICE_13/e.CV_PRICE_18;return t.innerHTML=`\n    <div class="catalog_content text-center" data-XML_ID="${e.IE_XML_ID}">\n        <div class="catalog-item" data-itemcategory="${e.IC_GROUP0}" data-itemsubcategories="${e.IC_GROUP1}" data-itemsubSubcategories="${e.IC_GROUP2}">\n            <div class="catalog-item__wrapper">\n                <div class="catalog-item__content catalog-item__content_active">\n                    <img src="${e.IE_DETAIL_PICTURE}" alt="${e.IE_NAME}" class="catalog-item__img">\n                </div>\n            </div>\n            <div class="catalog-item__footer_block">\n            <div class="catalog-item__subtitle">${e.IE_NAME}</div>\n                <hr>\n                <div class="catalog-item__footer">\n                    <div class="catalog-item__prices easynetshop-cur-old-price">\n                        <div class="catalog-item__old-price">${e.CV_PRICE_18||" "}</div>\n                        ${e.CV_PRICE_18?`<span class="discount">${parseInt(n)}%</span>`:""}\n                        <div data-price="${parseFloat(e.CV_PRICE_13)}" class="catalog-item__price">${e.CV_PRICE_13||" "} ₽</div>\n                    </div>\n                    <button class="add-to-cart catalog-item__btn" data-buy="buy_items">Добавить</button>\n                </div>\n                <a href="/category/products/${e.IC_GROUP0}/${e.IC_GROUP1}${e.IC_GROUP2?"/"+e.IC_GROUP2:""}/${encodeURIComponent(e.IE_NAME)}" target="_blank"><button class="catalog-item__link">Подробнее</button></a>\n            </div>\n        </div>\n    </div>\n`,t}function E(e,t){const n=Math.ceil(t.length/h);e=Math.min(e,n-1);const o=Math.floor(v/2);let c=e-o,a=e+o;c=Math.max(0,Math.min(c,n-v)),a=Math.min(n,c+v),C.forEach(((e,t)=>{e.style.display=t+1>=c&&t<a?"":"none"}))}function b(e,t){const n=y.querySelector(".active");n&&n.classList.remove("active"),e.classList.add("active");let o,c=+e.innerHTML,a=window.location.search,s=`page=${c}`;o=a.includes("page=")?a.replace(/page=\d+/,s):a?a+`&${s}`:`?${s}`,window.history.pushState({page:c},"",o);let r=(c-1)*g,l=t.slice(),i=r+g,d=l.slice(r,i);_.querySelectorAll(".col-auto").forEach((e=>e.remove()));for(let e of d)if(!_.querySelector(`[data-XML_ID="${e.IE_XML_ID}"]`)){const t=I(e);y.parentNode.insertBefore(t,y)}E(c-1,t)}function L(e){const{page:t}=function(){const e=new URLSearchParams(window.location.search).get("page");return{page:e?parseInt(e):1}}();C=[],y.innerHTML="";const n=Math.ceil(e.length/h);f=n;const o=document.createElement("li");o.classList.add("pagination-start"),o.classList.add("pagination-number"),o.innerHTML="начало",y.appendChild(o),o.addEventListener("click",(()=>{b(C[0],e)}));for(let o=1;o<=n;o++){const n=document.createElement("li");n.classList.add("pagination-number"),n.innerHTML=o,y.appendChild(n),C.push(n),o===t&&n.classList.add("active"),n.addEventListener("click",(()=>{b(n,e)}))}const c=document.createElement("li");c.classList.add("pagination-end"),c.classList.add("pagination-number"),c.innerHTML="Конец",y.appendChild(c),c.addEventListener("click",(()=>{b(C[C.length-1],e)})),E(t-1,e)}function S(e,t){const n=(e-1)*h,o=Math.min(n+h,t.length);for(let e=n;e<o;e++){const n=I(t[e]);_.insertBefore(n,y)}}const R=document.querySelector(".options");document.querySelector("#category_menu__profiles__CategoryText"),document.querySelector("#category_menu__profiles__SubCategoryText"),document.querySelector("#category_menu__profiles__subSubCategoryText");const P=document.getElementById("sort-asc"),q=document.getElementById("sort-desc");function w(e){_.querySelectorAll(".col-auto").forEach((e=>e.remove())),L(e),S(1,e)}function U(e){P.addEventListener("click",(function(t){e.sort(((e,t)=>e.CV_PRICE_13-t.CV_PRICE_13)),w(e)})),q.addEventListener("click",(function(t){e.sort(((e,t)=>t.CV_PRICE_13-e.CV_PRICE_13)),w(e)}))}window.addEventListener("DOMContentLoaded",(()=>{fetch("http://localhost:8080/categoryGroup").then((e=>e.json())).then((e=>{const t=document.getElementById("categories-list"),n=document.getElementById("categories-context"),o=e.filter(((e,t,n)=>t===n.findIndex((t=>t.IC_GROUP0===e.IC_GROUP0))));o.forEach(((e,n)=>{const o=document.createElement("li");o.classList.add("positionBlock"),o.innerHTML=`\n                    <button data-index="${n+1}">${e.IC_GROUP0}</button>\n                `,t.appendChild(o)})),o.forEach(((t,o)=>{const c=document.createElement("li");c.classList.add("positionBlock");const a=e.filter((e=>e.IC_GROUP0===t.IC_GROUP0)).reduce(((e,t)=>(e.includes(t.IC_GROUP1)||e.push(t.IC_GROUP1),e)),[]);c.innerHTML=`\n        <div class="ContextMenu ContextMenuSupport" id="menu${o+1}">\n            <ul>\n                ${a.map((n=>`\n                    <li>\n                        ${e.some((e=>e.IC_GROUP0===t.IC_GROUP0&&e.IC_GROUP1===n&&e.IC_GROUP2))?`<button class="collapsible">${n}</button>`:`<a href="category/products?category=${encodeURIComponent(t.IC_GROUP0)}&subcategory=${encodeURIComponent(n)}" target="_blank">${n}</a>`}\n                        <div class="content SubCategoryMenu">\n                            <ul>\n                                ${e.filter((e=>e.IC_GROUP0===t.IC_GROUP0&&e.IC_GROUP1===n)).map((e=>`\n                                    <li><a href="category/products?category=${encodeURIComponent(t.IC_GROUP0)}&subcategory=${encodeURIComponent(n)}&subsubcategory=${encodeURIComponent(e.IC_GROUP2)}" target="_blank">${e.IC_GROUP2}</a></li>`)).join("")}\n                            </ul>\n                        </div>\n                    </li>\n                `)).join("")}\n            </ul>\n        </div>\n    `,n.appendChild(c)}));const c=document.querySelectorAll(".positionBlock button"),a=document.querySelectorAll(".ContextMenuSupport");c.forEach((e=>{e.addEventListener("mouseenter",(t=>{const n=e.dataset.index,o=document.querySelector(`#menu${n}`);e.classList.contains("collapsible")||t.target===e&&(a.forEach((e=>{e.classList.remove("active")})),o.classList.add("active"))}))}));function s(){a.forEach((e=>{e.classList.remove("active")}))}document.querySelectorAll(".FrameCategory").forEach((e=>{let t;e.addEventListener("mouseleave",(()=>{t=setTimeout(s,500)})),e.addEventListener("mouseenter",(()=>{clearTimeout(t)}))}));let r,l=document.getElementsByClassName("collapsible");for(r=0;r<l.length;r++)l[r].addEventListener("click",(function(){this.classList.toggle("active");let e=this.nextElementSibling;e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"}))})).catch((e=>console.error("Ошибка загрузки категорий:",e)))}));0!=new URLSearchParams(window.location.search).getAll("category").length||fetch("http://localhost:8080/getProductsData").then((e=>{if(!e.ok)throw new Error("Ошибка HTTP: "+e.status);return e.json()})).then((e=>{_.querySelectorAll(".col-auto").forEach((e=>e.remove())),L(e),S(1,e),function(e){window.addEventListener("click",(function(t){const n=t.target,o=document.querySelectorAll(".btn_filter");if(Array.from(o).some((e=>e.contains(n)))&&(o.forEach((e=>e.classList.remove("active"))),n.classList.add("active")),n.classList.contains("btn_filter")){const t=n.getAttribute("data-default"),o=n.getAttribute("data-new"),c=n.getAttribute("data-discount");if(n.getAttribute("data-newTime"),null!==t)_.querySelectorAll(".col-auto").forEach((e=>e.remove())),L(e),S(1,e);else if(null!==o){const t=e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at)));_.querySelectorAll(".col-auto").forEach((e=>e.remove())),L(t),S(1,t)}else if(null!==c){const t=e.filter((e=>e.CV_PRICE_13&&e.CV_PRICE_18&&0!==e.CV_PRICE_18&&0!==e.CP_QUANTITY&&"Продукт снят с производства"!==e.IP_PROP140)).filter((e=>100-100*e.CV_PRICE_13/e.CV_PRICE_18>0)).sort(((e,t)=>(e.CV_PRICE_13-e.CV_PRICE_18)/e.CV_PRICE_13-(t.CV_PRICE_13-t.CV_PRICE_18)/t.CV_PRICE_13)).concat(e.filter((e=>e.CV_PRICE_13&&e.CV_PRICE_18&&0!==e.CV_PRICE_18&&0===e.CP_QUANTITY&&"Продукт снят с производства"!==e.IP_PROP140)));_.querySelectorAll(".col-auto").forEach((e=>e.remove())),L(t),S(1,t)}}}))}(e),U(e)}));const $=[],k=document.querySelector(".search"),x=document.querySelector(".options"),A=document.querySelector(".promo_search__form"),M=A.querySelector("i");let O=!1;function G(){const e=k.value.trim();if(e){const t=`http://localhost:8080/search?text=${encodeURIComponent(e)}`;window.open(t,"_blank")}}function T(e){const t=document.querySelector(".promo"),n=document.querySelector(".navMain"),o=document.querySelector(".promo_search_img");e.matches?(n.classList.remove("container"),t.classList.remove("container"),o.classList.remove("col-lg-8")):(t.classList.add("container"),n.classList.remove("container"),o.classList.add("col-lg-8"))}k.addEventListener("input",(function(){!function(e,t){const n=e.trim();if(!n)return R.innerHTML="",void(R.style.backgroundColor="transparent");const o=function(e,t){const n=e.trim().toLowerCase();return t.filter((e=>{const t=e.IE_NAME&&e.IE_NAME.toLowerCase().includes(n),o=e.IC_GROUP0&&e.IC_GROUP0.toLowerCase().includes(n)||e.IC_GROUP1&&e.IC_GROUP1.toLowerCase().includes(n)||e.IC_GROUP2&&e.IC_GROUP2.toLowerCase().includes(n);return t||o}))}(n,t),c=document.createDocumentFragment();o.slice(0,10).forEach((o=>{const a=new RegExp(n,"gi"),s=o.IE_NAME.replace(a,`<span class="hl">${e}</span>`),r=document.createElement("li");r.innerHTML=`<span>${s}</span>`,r.addEventListener("click",(function(e){const n=o.IC_GROUP0,c=o.IC_GROUP1,a=o.IC_GROUP2,s=o.IE_NAME;let r=[];if(!n&&c){const e=t.find((e=>e.IC_GROUP1===c))?.IC_GROUP0;r.push(`category=${encodeURIComponent(decodeURIComponent(e))}`),r.push(`subcategory=${encodeURIComponent(decodeURIComponent(c))}`),r.push(`search=${encodeURIComponent(decodeURIComponent(s))}`)}else r.push(`category=${encodeURIComponent(decodeURIComponent(n))}`),r.push(`subcategory=${encodeURIComponent(decodeURIComponent(c))}`),a&&r.push(`subsubcategory=${encodeURIComponent(decodeURIComponent(a))}`),r.push(`search=${encodeURIComponent(decodeURIComponent(s))}`);const l=`/category/products?${r.join("&")}`;window.open(l,"_blank"),e.stopPropagation(),e.preventDefault()})),c.appendChild(r)})),R.innerHTML="",R.appendChild(c),R.style.backgroundColor=o.length>0?"#ea7e67":"transparent"}(this.value,$)})),k.addEventListener("click",(function(){O||async function(e){try{const t=await fetch(e);if(!t.ok)throw new Error("Ошибка HTTP: "+t.status);const n=await t.json();$.push(...n),console.log("Данные успешно загружены:",$),O=!0}catch(e){console.error("Произошла ошибка при загрузке данных:",e)}}("http://localhost:8080/getProductsData")})),document.addEventListener("click",(function(e){A.contains(e.target)||(k.value="",x.innerHTML="",x.style.backgroundColor="transparent")})),k.addEventListener("keydown",(function(e){"Enter"===e.key&&G()})),M.addEventListener("click",G);const V=window.matchMedia("(max-width: 994px)");function B(e){const t=document.querySelector(".footer_content__container"),n=document.querySelector(".footer_content__row");e.matches?(t.classList.remove("container"),n.classList.add("row")):(t.classList.add("container"),n.classList.remove("row"))}T(V),V.addListener(T);const D=window.matchMedia("(max-width: 1200px)");B(D),D.addListener(B);const H=[e.p+"img/Promo_1.jpg",e.p+"img/Promo_2.jpg",e.p+"img/Promo_3.jpg"],N=document.querySelectorAll(".carousel_inner img");Array.from(N).map(((e,t)=>{e.src=H[t%H.length]}));const j=document.getElementById("myTopnav");j.addEventListener("click",(async()=>{const e=document.querySelector(".hamburger");try{"topnav"===j.className?j.className+=" responsive":j.className="topnav",e.classList.toggle("hamburger_active")}catch(e){console.error("Произошла ошибка:",e)}}))})();