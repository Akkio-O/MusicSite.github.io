$(document).ready((function(){function e(){const e=$("#overlay_profile"),r=$("#trigger_profile"),t=$(".closebtn");r.on("click",(function(e){e.stopPropagation(),function(){const e=$("#overlay_profile"),o=$("#trigger_profile");e.css("width","250px"),o.css("margin-left","250px"),$("body").css("background-color","rgba(0,0,0,0.4)")}()})),t.on("click",(function(){o()})),$(document).on("click",(function(r){e.is(r.target)||0!==e.has(r.target).length||o()})),e.on("click",(function(e){e.stopPropagation()}))}function o(){const e=$("#overlay_profile"),o=$("#trigger_profile");e.css("width","0"),o.css("margin-left","0"),$("body").css("background-color","white")}function r(e){$(e).validate({rules:{firstName:"required",lastName:"required",phone:"required",password:{required:!0,minlength:6},confirm_password:{required:!0,equalTo:'[name="password"]'},email:{required:!0,email:!0}},messages:{firstName:"Пожалуйста, заполните свое имя",lastName:"Пожалуйста, заполните свою фамилию",phone:"Пожалуйста, заполните свой номер телефона",password:{required:"Пожалуйста, заполните пароль",minlength:"Пароль должен содержать не менее 6 символов"},confirm_password:{required:"Пожалуйста, повторите пароль",equalTo:"Пароли не совпадают"},email:{required:"Пожалуйста, заполните свою почту",email:"Неправильно введен адрес почты"}}})}function t(e){$(".reg_login_btn").hide(),$(".profile").html(`\n        <div class="profile__wrapper">\n            <div class="profile__img_wrapper" id="trigger_profile">\n                <img src="../img/carousel/Promo_2.jpg" onclick="openNav()" alt="Profile_Image" class="profile__img">\n                <span>${e}</span>\n            </div>\n        </div>\n        <div id="overlay_profile" class="overlay_profile">\n            <a href="javascript:void(0)" class="closebtn">×</a>\n            <div class="main_profile__img_wrapper">\n                <img src="img/carousel/Promo_2.jpg" alt="" class="main_profile__img">\n                <span>${e}</span>\n            </div><br>\n            <a href="#" data-profile>Профиль</a>\n            <a href="#" data-exit>Выход</a>\n        </div>\n    `),$("[data-exit]").on("click",(function(){o(),$(".profile").empty(),$(".reg_login_btn").show()}))}$.get("/csrf-token",(function(o){$('input[name="_csrf"]').val(o.csrfToken);var r=$("#log form");r.submit((function(o){o.preventDefault();var a=$("input[name=_csrf]").val();$.ajax({type:"POST",url:"http://localhost:8080/log",data:$(this).serialize(),headers:{"CSRF-Token":a}}).done((function(o){r.find("input").val(""),$(".overlay, #reg, #log").fadeOut("slow"),r.trigger("reset");t(o.firstName),e()})).fail((function(e,o,r){console.log("Ошибка авторизации:",o,r)}))}))})),$(".modal-trigger").on("click",(function(){let e=$(this).data("modal");$(".overlay, #"+e).fadeIn("slow")})),$("#log .modal-trigger").click((function(){$("#log").fadeOut(),$("#reg").fadeIn()})),$(".btn_back").on("click",(function(){$(this).closest(".modal").fadeOut("slow"),$(".overlay").fadeOut("slow")})),$(".modal_close").on("click",(function(){$(this).closest(".modal").fadeOut("slow"),$(".overlay").fadeOut("slow")})),$(".overlay").on("click",(function(e){$(e.target).hasClass("overlay")&&($(this).find(".modal").fadeOut("slow"),$(this).fadeOut("slow"))})),$(".btn_buy__decoration").on("click",(function(){$(this).closest(".modal").fadeOut("slow");let e=$(this).data("modal");$(".overlay, #"+e).fadeIn("slow")})),r("#reg form"),r("#log form"),$("#reg form").submit((function(o){o.preventDefault();const r=$(this).serializeArray();for(let e=0;e<r.length;e++)if(void 0===r[e].value||null===r[e].value)return alert("Пожалуйста, заполните все поля"),!1;const a=$('[name="password"]').val(),n=$('[name="confirm_password"]').val();return console.log("Password:",a),console.log("Confirm Password:",n),a!==n||$.ajax({type:"POST",url:"http://localhost:8080/reg",data:$(this).serialize()}).done((function(o){$(this).find("input").val(""),$(".overlay, #reg, #log").fadeOut();const r=o.firstName;$("form").trigger("reset"),t(r),e()})),!1})),$(".finally_buy__btn").click((function(e){e.preventDefault();var o={userName:"testUserName",password:"testPassword",orderNumber:"e2574f1785324f1592d9029cb05adbbd",amount:19900,returnUrl:"https://testmerchant.ru/return",features:"FORCE_SSL"};console.log(o),$.ajax({type:"POST",url:"http://localhost:8080/register_order",contentType:"application/json",data:JSON.stringify(o),success:function(e){console.log(e)},error:function(e,o,r){console.error(r)}})})),$(window).scroll((function(){$(this).scrollTop()>1600?$(".pageup").fadeIn():$(".pageup").fadeOut()})),$("a[href^='#']").click((function(){const e=$(this).attr("href");return $("htnl, body").animate({scrollTop:$(e).offset().top+"px"}),!1})),(new WOW).init()}));